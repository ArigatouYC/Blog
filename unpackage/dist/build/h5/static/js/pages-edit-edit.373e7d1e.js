(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-edit-edit"],{"3c82":function(t,n,e){"use strict";(function(t){e("7a82");var i=e("4ea4").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(e("5530")),a=i(e("c7eb")),c=i(e("b85c")),s=i(e("1da1"));e("a4d3"),e("e01a"),e("fb6a"),e("ac1f");var l=e("6d12"),r=t.database(),d={data:function(){return{isActive:{bold:!1,italic:!1,underline:!1},blogContent:{title:"",content:"",imgSrc:"",ipInfo:{province:"",city:""}},description:""}},onLoad:function(){var t=this;(0,l.getAddByIP)().then((function(n){t.blogContent.ipInfo.province=n.data.province,t.blogContent.ipInfo.city=n.data.city}))},methods:{onSubmit:function(){var t=this;this.editorCtx.getContents({success:function(n){t.description=n.text.slice(0,80)}})},onEditorReady:function(){var t=this;uni.createSelectorQuery().in(this).select("#editor").fields({size:!0,context:!0},(function(n){console.log(n),t.editorCtx=n.context})).exec()},insertDivider:function(){this.editorCtx.insertDivider()},handleBold:function(){this.isActive.bold=!this.isActive.bold,this.editorCtx.format("bold")},handleItalic:function(){this.isActive.italic=!this.isActive.italic,this.editorCtx.format("italic")},handleUnderline:function(){this.isActive.underline=!this.isActive.underline,this.editorCtx.format("underline")},addImage:function(){var n=this;uni.chooseImage({success:function(){var e=(0,s.default)((0,a.default)().mark((function e(i){var o,s,l,r;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:uni.showLoading({title:"Loading...",mask:!0}),o=(0,c.default)(i.tempFiles),e.prev=2,o.s();case 4:if((s=o.n()).done){e.next=13;break}return l=s.value,e.next=8,t.uploadFile({filePath:l.path,cloudPath:l.name});case 8:r=e.sent,console.log(r),n.editorCtx.insertImage({src:r.fileID});case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](2),o.e(e.t0);case 18:return e.prev=18,o.f(),e.finish(18);case 21:uni.hideLoading();case 22:case"end":return e.stop()}}),e,null,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()})},upload:function(){var t=this;this.editorCtx.getContents({success:function(n){t.blogContent.content=n.delta.ops[0].insert,t.blogContent.imgSrc=(0,l.getImgSrc)(n.html),console.log(t.blogContent),uni.showLoading({title:"Loading..."}),t.addData()}})},addData:function(){this.description?r.collection("blog").add((0,o.default)({},this.blogContent)).then((function(t){uni.hideLoading(),uni.showToast({title:"发布成功"}),setTimeout((function(){uni.reLaunch({url:"/pages/index/index"})}),800)})):uni.showToast({icon:"none",title:"请输入内容哦"})}}};n.default=d}).call(this,e("a9ff")["default"])},"5c39":function(t,n,e){"use strict";var i=e("727a"),o=e.n(i);o.a},"6d12":function(t,n,e){"use strict";e("7a82"),Object.defineProperty(n,"__esModule",{value:!0}),n.getAddByIP=function(){return new Promise((function(t,n){uni.request({url:"https://restapi.amap.com/v3/ip",data:{key:"8f6cef18e3a4c44188360a38a45c3a88"},success:function(n){t(n)},fail:function(t){n(t)}})}))},n.getImgSrc=function(t){var n=[];return t.replace(/img[^>]*src=['"]([^'"]+)[^>]*>/g,(function(t,e){n.push(e)})),n},e("ac1f"),e("5319"),e("14d9"),e("d3b7")},"727a":function(t,n,e){var i=e("876f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=e("4f06").default;o("23f22d56",i,!0,{sourceMap:!1,shadowMode:!1})},"84a4":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return o})),e.d(n,"a",(function(){}));var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"box"},[e("v-uni-view",{staticClass:"titleInput"},[e("v-uni-input",{attrs:{type:"text",placeholder:"输入标题","placeholder-class":"placeholder-class"},model:{value:t.blogContent.title,callback:function(n){t.$set(t.blogContent,"title",n)},expression:"blogContent.title"}})],1),e("v-uni-view",{staticClass:"contentInput"},[e("v-uni-editor",{attrs:{placeholder:"正文",id:"editor"},on:{ready:function(n){arguments[0]=n=t.$handleEvent(n),t.onEditorReady.apply(void 0,arguments)},click:function(n){arguments[0]=n=t.$handleEvent(n),t.onSubmit.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"toolsAndSubmit"},[e("v-uni-view",{staticClass:"tools"},[e("v-uni-view",{staticClass:"tool",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.handleBold.apply(void 0,arguments)}}},[e("v-uni-text",{class:t.isActive.bold?"active":""},[e("span",{staticClass:"iconfont"},[t._v("")])])],1),e("v-uni-view",{staticClass:"tool",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.handleItalic.apply(void 0,arguments)}}},[e("v-uni-text",{class:t.isActive.italic?"active":""},[e("span",{staticClass:"iconfont"},[t._v("")])])],1),e("v-uni-view",{staticClass:"tool",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.handleUnderline.apply(void 0,arguments)}}},[e("v-uni-text",{class:t.isActive.underline?"active":""},[e("span",{staticClass:"iconfont"},[t._v("")])])],1),e("v-uni-view",{staticClass:"tool",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.addImage.apply(void 0,arguments)}}},[e("v-uni-text",[e("span",{staticClass:"iconfont"},[t._v("")])])],1),e("v-uni-view",{staticClass:"tool",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.insertDivider.apply(void 0,arguments)}}},[e("v-uni-text",[e("span",{staticClass:"iconfont"},[t._v("")])])],1)],1),e("v-uni-view",{staticClass:"submitbtn"},[e("v-uni-button",{attrs:{type:"primary",disabled:!t.blogContent.title.length},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.upload.apply(void 0,arguments)}}},[t._v("发布")])],1)],1)],1)},o=[]},"876f":function(t,n,e){var i=e("24fb");n=i(!1),n.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* uni.scss */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.box[data-v-45c13ce4]{padding:%?20?%}.box .titleInput[data-v-45c13ce4]{padding:%?30?%;border:%?3?% #0199fe solid;border-radius:%?20?%}.box .titleInput .placeholder-class[data-v-45c13ce4]{font-size:%?40?%}.box .contentInput[data-v-45c13ce4]{height:%?800?%;border-radius:%?20?%;margin-top:%?30?%;padding:%?30?%;border:%?3?% #0199fe solid}.box .contentInput #editor[data-v-45c13ce4]{height:%?800?%;margin-bottom:%?30?%}.toolsAndSubmit[data-v-45c13ce4]{position:fixed;width:95%;bottom:%?30?%}.toolsAndSubmit .tools[data-v-45c13ce4]{display:flex;justify-content:space-around;align-items:center;margin-bottom:%?20?%}.toolsAndSubmit .tools .iconfont[data-v-45c13ce4]{font-size:%?50?%}.toolsAndSubmit .active[data-v-45c13ce4]{color:#0199fe}',""]),t.exports=n},b382:function(t,n,e){"use strict";e.r(n);var i=e("84a4"),o=e("bbc3");for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(n,t,(function(){return o[t]}))}(a);e("5c39");var c=e("f0c5"),s=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,"45c13ce4",null,!1,i["a"],void 0);n["default"]=s.exports},bbc3:function(t,n,e){"use strict";e.r(n);var i=e("3c82"),o=e.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(a);n["default"]=o.a}}]);